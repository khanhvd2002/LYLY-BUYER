import{r as X,M as Z}from"./VAvatar-89ad20fc.js";import{m as _e,e as le,u as we,f as te,h as ae,b as Ce,o as Pe,V as De}from"./VChip-34702d29.js";import{g as ke}from"./index-30d4c17e.js";import{T as Te,Q as Fe}from"./QRcode.vue_vue_type_style_index_0_scoped_7e7556d3_lang-489fc7d6.js";import{_ as ne,q as re,o as p,f as T,h as r,i as $,t as k,e as R,w as m,j as x,a as ie,av as ue,G as J,au as be,C as M,y as B,$ as xe,aa as Se,A as Oe,M as b,u as de,d as l,K as ce,Y as Ie,E as Ue,aw as Me,H as Be,F as H,ax as Le,r as se,L as Re,p as Ee,l as qe}from"./index-d8bdc496.js";import{m as Ae,v as Ne,a as He}from"./visa-0ce6805b.js";import{V as Ke}from"./VCard-1e8bcd02.js";import{V as W}from"./VDivider-b6f72085.js";import{V as z}from"./VRow-a0998b98.js";import{V as U}from"./VCol-2f8f9c79.js";import{m as Qe,V as E}from"./VTextField-952090ec.js";import{b as me}from"./VCounter-f846fe82.js";import{m as je,u as Ge,c as We,b as oe}from"./VList-c151f906.js";import{m as ze}from"./VImg-d0ac8ec7.js";import{a as Ye}from"./VInput-bf41ae86.js";import{V as Je}from"./VCheckboxBtn-3f03a174.js";import{V as Xe,a as Ze}from"./VRadioGroup-ba8da0e0.js";import"./lazy-93080ec6.js";import"./getScrollParent-7b3d9385.js";import"./index-a4fb869b.js";import"./index-3dc29f8e.js";import"./createSimpleFunctional-0b4fdfea.js";import"./ssrBoot-46c30e5a.js";import"./VSelectionControl-afd661f8.js";const $e={components:{QrcodeStream:Te,QrcodeVue:Fe},props:{isShow:!0},data(){return{value:"00020101021138580010A000000727012800069704070114190365724760110208QRIBFTTA53037045802VN830084006304C3D7",isValid:void 0,paused:!1,result:null}},computed:{validationPending(){return this.isValid===void 0&&this.paused},validationSuccess(){return this.isValid===!0},validationFailure(){return this.isValid===!1}},methods:{onError:console.error,resetValidationState(){this.isValid=void 0},async onDetect([e]){this.result=e.rawValue,this.paused=!0,await this.timeout(3e3),this.isValid=this.result.startsWith("http"),await this.timeout(2e3),this.paused=!1,this.$router.push({name:"order"})},timeout(e){return new Promise(n=>{window.setTimeout(n,e)})}}},et={class:"decode-result"},tt={key:0,class:"validation-success"},at={key:1,class:"validation-failure"},st={key:2,class:"validation-pending"};function ot(e,n,s,v,t,c){const V=re("qrcode-stream");return p(),T("div",null,[r("p",et,[$(" Last result: "),r("b",null,k(t.result),1)]),s.isShow?(p(),R(V,{key:0,style:{width:"300px",height:"300px","border-radius":"8px"},paused:t.paused,onDetect:c.onDetect,onError:c.onError,onCameraOn:c.resetValidationState},{default:m(()=>[c.validationSuccess?(p(),T("div",tt,"This is a URL")):x("",!0),c.validationFailure?(p(),T("div",at,"This is NOT a URL!")):x("",!0),c.validationPending?(p(),T("div",st,"Long validation in progress...")):x("",!0)]),_:1},8,["paused","onDetect","onError","onCameraOn"])):x("",!0)])}const lt=ne($e,[["render",ot],["__scopeId","data-v-7e7556d3"]]);function nt(){return X({url:"/provices",headers:{"Content-Type":"application/json"},method:Z.GET})}function rt(e){return X({url:"/districts",headers:{"Content-Type":"application/json"},method:Z.GET,params:e})}function it(e){return X({url:"/wards",headers:{"Content-Type":"application/json"},method:Z.GET,params:e})}const ut="/lyly-web/assets/cod-a54ca300.png";const dt=ie()({name:"VMenu",props:{id:String,...ue(_e({closeDelay:250,closeOnContentClick:!0,locationStrategy:"connected",openDelay:300,scrim:!1,scrollStrategy:"reposition",transition:{component:le}}),["absolute"])},emits:{"update:modelValue":e=>!0},setup(e,n){let{slots:s}=n;const v=J(e,"modelValue"),{scopeId:t}=we(),c=be(),V=M(()=>e.id||`v-menu-${c}`),a=B(),d=xe(te,null),S=B(0);Se(te,{register(){++S.value},unregister(){--S.value},closeParents(){setTimeout(()=>{S.value||(v.value=!1,d==null||d.closeParents())},40)}}),Oe(v,g=>{g?d==null||d.register():d==null||d.unregister()});function Q(){d==null||d.closeParents()}const h=M(()=>b({"aria-haspopup":"menu","aria-expanded":String(v.value),"aria-owns":V.value},e.activatorProps));return de(()=>{const[g]=ae.filterProps(e);return l(ae,b({ref:a,class:["v-menu",e.class],style:e.style},g,{modelValue:v.value,"onUpdate:modelValue":C=>v.value=C,absolute:!0,activatorProps:h.value,"onClick:outside":Q},t),{activator:s.activator,default:function(){for(var C=arguments.length,L=new Array(C),_=0;_<C;_++)L[_]=arguments[_];return l(ce,{root:!0},{default:()=>{var O;return[(O=s.default)==null?void 0:O.call(s,...L)]}})}})}),me({id:V,ΨopenChildren:S},a)}}),ct=Ie({chips:Boolean,closableChips:Boolean,eager:Boolean,hideNoData:Boolean,hideSelected:Boolean,menu:Boolean,menuIcon:{type:Ue,default:"$dropdown"},menuProps:{type:Object},multiple:Boolean,noDataText:{type:String,default:"$vuetify.noDataText"},openOnClear:Boolean,valueComparator:{type:Function,default:Me},...je({itemChildren:!1})},"v-select"),Y=ie()({name:"VSelect",props:{...ct(),...ue(Qe({modelValue:null}),["validationValue","dirty","appendInnerIcon"]),...ze({transition:{component:le}})},emits:{"update:focused":e=>!0,"update:modelValue":e=>!0,"update:menu":e=>!0},setup(e,n){let{slots:s}=n;const{t:v}=Be(),t=B(),c=B(),V=J(e,"menu"),a=M({get:()=>V.value,set:o=>{var u;V.value&&!o&&((u=c.value)!=null&&u.ΨopenChildren)||(V.value=o)}}),{items:d,transformIn:S,transformOut:Q}=Ge(e),h=J(e,"modelValue",[],o=>S(Le(o)),o=>{const u=Q(o);return e.multiple?u:u[0]??null}),g=Ye(),C=M(()=>h.value.map(o=>d.value.find(u=>e.valueComparator(u.value,o.value))||o)),L=M(()=>C.value.map(o=>o.props.value)),_=B(!1);let O="",ee;const j=M(()=>e.hideSelected?d.value.filter(o=>!C.value.some(u=>u===o)):d.value),I=B();function he(o){e.openOnClear&&(a.value=!0)}function pe(){e.hideNoData&&!d.value.length||e.readonly||g!=null&&g.isReadonly.value||(a.value=!a.value)}function fe(o){var i,D,F,y;if(e.readonly||g!=null&&g.isReadonly.value)return;["Enter"," ","ArrowDown","ArrowUp","Home","End"].includes(o.key)&&o.preventDefault(),["Enter","ArrowDown"," "].includes(o.key)&&(a.value=!0),["Escape","Tab"].includes(o.key)&&(a.value=!1),o.key==="ArrowDown"?(i=I.value)==null||i.focus("next"):o.key==="ArrowUp"?(D=I.value)==null||D.focus("prev"):o.key==="Home"?(F=I.value)==null||F.focus("first"):o.key==="End"&&((y=I.value)==null||y.focus("last"));const u=1e3;function P(f){const w=f.key.length===1,G=!f.ctrlKey&&!f.metaKey&&!f.altKey;return w&&G}if(e.multiple||!P(o))return;const A=performance.now();A-ee>u&&(O=""),O+=o.key.toLowerCase(),ee=A;const N=d.value.find(f=>f.title.toLowerCase().startsWith(O));N!==void 0&&(h.value=[N])}function q(o){if(e.multiple){const u=L.value.findIndex(P=>e.valueComparator(P,o.value));if(u===-1)h.value=[...h.value,o];else{const P=[...h.value];P.splice(u,1),h.value=P}}else h.value=[o],a.value=!1}function ve(o){var u;(u=I.value)!=null&&u.$el.contains(o.relatedTarget)||(a.value=!1)}function ye(o){_.value=!0}function Ve(o){var u;o.relatedTarget==null&&((u=t.value)==null||u.focus())}return de(()=>{const o=!!(e.chips||s.chip),u=!!(!e.hideNoData||j.value.length||s.prepend||s.append||s["no-data"]),P=h.value.length>0,[A]=E.filterProps(e),N=P||!_.value&&e.label&&!e.persistentPlaceholder?void 0:e.placeholder;return l(E,b({ref:t},A,{modelValue:h.value.map(i=>i.props.value).join(", "),"onUpdate:modelValue":i=>{i==null&&(h.value=[])},focused:_.value,"onUpdate:focused":i=>_.value=i,validationValue:h.externalValue,dirty:P,class:["v-select",{"v-select--active-menu":a.value,"v-select--chips":!!e.chips,[`v-select--${e.multiple?"multiple":"single"}`]:!0,"v-select--selected":h.value.length},e.class],style:e.style,appendInnerIcon:e.menuIcon,readonly:!0,placeholder:N,"onClick:clear":he,"onMousedown:control":pe,onBlur:ve,onKeydown:fe}),{...s,default:()=>l(H,null,[l(dt,b({ref:c,modelValue:a.value,"onUpdate:modelValue":i=>a.value=i,activator:"parent",contentClass:"v-select__content",eager:e.eager,maxHeight:310,openOnClick:!1,closeOnContentClick:!1,transition:e.transition},e.menuProps),{default:()=>[u&&l(We,{ref:I,selected:L.value,selectStrategy:e.multiple?"independent":"single-independent",onMousedown:i=>i.preventDefault(),onFocusin:ye,onFocusout:Ve},{default:()=>{var i,D,F;return[!j.value.length&&!e.hideNoData&&(((i=s["no-data"])==null?void 0:i.call(s))??l(oe,{title:v(e.noDataText)},null)),(D=s["prepend-item"])==null?void 0:D.call(s),j.value.map((y,f)=>{var w;return s.item?(w=s.item)==null?void 0:w.call(s,{item:y,index:f,props:b(y.props,{onClick:()=>q(y)})}):l(oe,b({key:f},y.props,{onClick:()=>q(y)}),{prepend:G=>{let{isSelected:ge}=G;return e.multiple&&!e.hideSelected?l(Je,{modelValue:ge,ripple:!1,tabindex:"-1"},null):void 0}})}),(F=s["append-item"])==null?void 0:F.call(s)]}})]}),C.value.map((i,D)=>{var f;function F(w){w.stopPropagation(),w.preventDefault(),q(i)}const y={"onClick:close":F,modelValue:!0,"onUpdate:modelValue":void 0};return l("div",{key:i.value,class:"v-select__selection"},[o?s.chip?l(ce,{key:"chip-defaults",defaults:{VChip:{closable:e.closableChips,size:"small",text:i.title}}},{default:()=>{var w;return[(w=s.chip)==null?void 0:w.call(s,{item:i,index:D,props:y})]}}):l(Ce,b({key:"chip",closable:e.closableChips,size:"small",text:i.title},y),null):((f=s.selection)==null?void 0:f.call(s,{item:i,index:D}))??l("span",{class:"v-select__selection-text"},[i.title,e.multiple&&D<C.value.length-1&&l("span",{class:"v-select__selection-comma"},[$(",")])])])})])})}),me({isFocused:_,menu:a,select:q},t)}}),mt={name:"preOrder",components:{QRcode:lt},props:{order:[],selectedIds:[]},data(){return{show:!1,isValidate:!1,userInfo:{},payMethod:[{logo:ut,value:"Thanh toán khi nhận hàng"},{logo:Ae,value:"Momo"},{logo:Ne,value:"ViettelPay"},{logo:He,value:"Visa"}],provinceData:[],wardsData:[],districtData:[],name:"",phone:"",formOrder:{note:"",delivery_address:"",product_id:"",quantity:"",selectIds:[],payMethod:""},addressForm:{stress:"",district:"",ward:"",province:""},rules:{required:e=>e?!0:"Trường này phải điền",counter:e=>e.length>0||"Lớn hơn 0"}}},created(){this.getDataProvince(),ke().then(e=>{this.name=e.data.info.name,this.phone=e.data.info.phone}),this.formOrder.selectIds=this.selectedIds},computed:{isValidate(){return!!(this.addressForm.stress&&this.addressForm.district&&this.addressForm.ward&&this.addressForm.province&&this.formOrder.payMethod)},totalPrice(){return this.selectedIds?this.order.reduce((e,n)=>e+n.total,0):this.order[0].flowPrice}},methods:{getDataProvince(){nt().then(e=>{this.provinceData=e.data})},getDataDistrict(e){rt({province_code:e}).then(n=>{this.districtData=n.data,this.addressForm.district="",this.addressForm.ward=""})},getDataWards(e){it({district_code:e}).then(n=>{this.wardsData=n.data,this.addressForm.ward=""})},handleShowQR(){},goPay(){const e=this.provinceData.find(t=>t.code==this.addressForm.province).full_name,n=this.districtData.find(t=>t.code==this.addressForm.district).full_name,s=this.wardsData.find(t=>t.code==this.addressForm.ward).full_name;this.formOrder.delivery_address=this.addressForm.stress+" - "+s+" - "+n+" - "+e,this.formOrder.product_id=this.order[0].product_detail.id,this.formOrder.quantity=this.order[0].quantity,this.formOrder.note=this.name+" "+this.phone,console.log(this.formOrder);let v=this.$loading.show();Pe(this.formOrder).then(t=>{this.$router.push({name:"order"}),this.$moshaToast("Đặt hàng thành công",{type:"success",transition:"slide"})}).catch(t=>{this.$moshaToast("Đặt hàng thất bai",{type:"success",transition:"slide",hideProgressBar:"true",timeOut:2e3})}),v.hide()}}},K=e=>(Ee("data-v-92ec4ba2"),e=e(),qe(),e),ht=K(()=>r("h2",{style:{"text-align":"center",margin:"1rem 0",color:"#CE5A67"}},"THÔNG TIN ĐẶT SẢN PHẨM",-1)),pt={class:"pay-containter"},ft=K(()=>r("h3",{class:"header-text sticky-top-50"},"Thông tin sản phẩm",-1)),vt={class:"product-detail"},yt=["src"],Vt={class:"name"},gt={class:"clamp-text",style:{width:"30%","font-size":"14px"}},_t=K(()=>r("h3",{class:"header-text sticky-top-50"},"Thông tin người nhận",-1)),wt={class:"user"},Ct=K(()=>r("h3",{class:"header-text sticky-top-50"},"Phương thức thanh toán",-1)),Pt={class:"logo-list"},Dt={style:{display:"flex","margin-bottom":"10px","align-items":"center",gap:"10px"}},kt=["src","alt"],Tt={class:"pay-footer"},Ft={class:"info hidden-xs"},bt={class:"price-total"},xt={style:{"text-align":"center"}};function St(e,n,s,v,t,c){const V=re("QRcode");return p(),T(H,null,[l(Ke,null,{default:m(()=>[ht,l(W),r("div",pt,[ft,(p(!0),T(H,null,se(s.order,(a,d)=>(p(),T("div",{key:d},[r("div",vt,[r("img",{width:"100",height:"100",src:a.product_detail.image_url,alt:""},null,8,yt),r("div",Vt,[r("span",gt,"Tên sản phẩm: "+k(a.product_detail.name),1),r("span",null,"Số lượng: "+k(a.quantity),1),r("span",null,"Đơn giá: "+k(e.formatPrice(a.product_detail.price)),1),r("span",null,k(a.total?e.formatPrice(a.total):e.formatPrice(a.flowPrice)),1)])])]))),128)),l(W,{style:{margin:"2rem 0"}}),_t,r("div",wt,[l(z,null,{default:m(()=>[l(U,{cols:"12",sm:"6"},{default:m(()=>[l(E,{label:"Tên người nhận",modelValue:t.name,"onUpdate:modelValue":n[0]||(n[0]=a=>t.name=a),rules:[t.rules.required]},null,8,["modelValue","rules"])]),_:1}),l(U,{cols:"12",sm:"6"},{default:m(()=>[l(E,{label:"Số điện thoại",modelValue:t.phone,"onUpdate:modelValue":n[1]||(n[1]=a=>t.phone=a),rules:[t.rules.required]},null,8,["modelValue","rules"])]),_:1})]),_:1}),l(z,null,{default:m(()=>[l(U,{cols:"12",sm:"6"},{default:m(()=>[l(Y,{label:"Tên tỉnh/ Thành phố",items:t.provinceData,"item-title":"full_name","item-value":"code","onUpdate:modelValue":[c.getDataDistrict,n[2]||(n[2]=a=>t.addressForm.province=a)],modelValue:t.addressForm.province,rules:[t.rules.required]},null,8,["items","onUpdate:modelValue","modelValue","rules"])]),_:1}),l(U,{cols:"12",sm:"6"},{default:m(()=>[t.addressForm.province?(p(),R(Y,{key:0,label:"Tên quận/ Huyện",items:t.districtData,"item-title":"full_name","item-value":"code","onUpdate:modelValue":[c.getDataWards,n[3]||(n[3]=a=>t.addressForm.district=a)],modelValue:t.addressForm.district,rules:[t.rules.required]},null,8,["items","onUpdate:modelValue","modelValue","rules"])):x("",!0)]),_:1})]),_:1}),l(z,null,{default:m(()=>[l(U,{cols:"12",sm:"6"},{default:m(()=>[t.addressForm.district?(p(),R(Y,{key:0,label:"Tên xã/ Phường",items:t.wardsData,"item-title":"full_name","item-value":"code",modelValue:t.addressForm.ward,"onUpdate:modelValue":n[4]||(n[4]=a=>t.addressForm.ward=a),"item-props":"fullname",rules:[t.rules.required]},null,8,["items","modelValue","rules"])):x("",!0)]),_:1}),l(U,{cols:"12",sm:"6"},{default:m(()=>[t.addressForm.ward?(p(),R(E,{key:0,label:"Tên Đường",modelValue:t.addressForm.stress,"onUpdate:modelValue":n[5]||(n[5]=a=>t.addressForm.stress=a),rules:[t.rules.required]},null,8,["modelValue","rules"])):x("",!0)]),_:1})]),_:1})]),l(W,{style:{margin:"2rem 0"}}),Ct,r("ul",Pt,[l(Xe,{modelValue:t.formOrder.payMethod,"onUpdate:modelValue":n[6]||(n[6]=a=>t.formOrder.payMethod=a)},{default:m(()=>[(p(!0),T(H,null,se(t.payMethod,a=>(p(),R(Ze,{key:a.value,value:a.value},{label:m(()=>[r("div",Dt,[r("img",{width:"60",height:"60",src:a.logo,alt:a.value,class:"footer-payment-icon"},null,8,kt),r("h4",null,k(a.value),1)])]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"])]),r("div",Tt,[r("div",Ft,[r("span",null,"Tên người nhận: "+k(t.name),1),r("span",null,"Số điện thoại: "+k(t.phone),1)]),r("span",bt,k(e.formatPrice(c.totalPrice)),1),l(Re,{disabled:!c.isValidate,color:"success",onClick:c.goPay},{default:m(()=>[$("Thanh toán")]),_:1},8,["disabled","onClick"])])])]),_:1}),l(De,{transition:"",modelValue:t.show,"onUpdate:modelValue":n[7]||(n[7]=a=>t.show=a)},{default:m(()=>[r("div",xt,[l(V,{"is-show":t.show},null,8,["is-show"])])]),_:1},8,["modelValue"])],64)}const ta=ne(mt,[["render",St],["__scopeId","data-v-92ec4ba2"]]);export{ta as default};
